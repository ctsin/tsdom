{"version":3,"sources":["tsdom.inc.js"],"names":["f","exports","module","define","amd","window","global","self","this","tsdom","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length","1","default","./index","2","Object","defineProperty","value","TSDom","qry","ctx","meta","els","document","regex","events","query","nodeType","len","prototype","find","owner","each","cb","css","obj","el","key","val","style","setProperty","hasClass","str","result","className","replace","indexOf","addClass","_this","removeClass","reg","RegExp","on","ev","op1","op2","direct","undefined","child","off","addEventListener","hit","_el","target","push","type","handler","active","findEvent","removeEventListener","filter","evt","event","append","html","insertAdjacentHTML","prepend","test","match","doc","exec","getElementsByClassName","getElementsByTagName","getElementById","querySelectorAll","_ev","preventDefault","returnValue"],"mappings":"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","file":"tsdom.inc.js","sourcesContent":["(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.tsdom = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\nmodule.exports = require('./index').default;\n},{\"./index\":2}],2:[function(require,module,exports){\n\"use strict\";\r\n/* -----------------------------------\r\n *\r\n * Meta\r\n *\r\n * -------------------------------- */\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/* -----------------------------------\r\n *\r\n * TSDom\r\n *\r\n * -------------------------------- */\r\nvar TSDom = (function () {\r\n    function TSDom(qry, ctx, meta) {\r\n        var els;\r\n        this.document = document;\r\n        this.meta = meta || {};\r\n        this.regex = /^(?:#([\\w-]+)|(\\w+)|\\.([\\w-]+))$/;\r\n        this.events = [];\r\n        if (typeof qry === 'string') {\r\n            els = this.query(qry, ctx ? ctx : document);\r\n        }\r\n        else {\r\n            els = qry;\r\n        }\r\n        if (!els)\r\n            return this;\r\n        if (els.nodeType === 1 || els === window) {\r\n            this[0] = els;\r\n            this.length = 1;\r\n        }\r\n        else {\r\n            for (var len = (this.length = els.length); len--; this[len] = els[len])\r\n                ;\r\n        }\r\n    }\r\n    TSDom.prototype.find = function (qry) {\r\n        return new TSDom(qry, this[0], { owner: this });\r\n    };\r\n    TSDom.prototype.each = function (cb) {\r\n        for (var i = 0, len = this.length; i < len;) {\r\n            var el = this[i];\r\n            if (cb.call(this, this[i], i++) == false) {\r\n                break;\r\n            }\r\n        }\r\n        return this;\r\n    };\r\n    TSDom.prototype.css = function (obj) {\r\n        var self = this;\r\n        this.each(function (el) {\r\n            for (var key in obj) {\r\n                var val = obj[key];\r\n                el.style.setProperty(key, val);\r\n            }\r\n        });\r\n        return this;\r\n    };\r\n    TSDom.prototype.hasClass = function (str) {\r\n        var result = false;\r\n        this.each(function (el) {\r\n            var value = \" \" + str + \" \";\r\n            var clean = (\" \" + el.className + \" \").replace(/[\\n\\t]/g, ' ');\r\n            if (clean.indexOf(value) > -1) {\r\n                result = true;\r\n            }\r\n        });\r\n        return result;\r\n    };\r\n    TSDom.prototype.addClass = function (str) {\r\n        var _this = this;\r\n        this.each(function (el) {\r\n            if (!_this.hasClass(str)) {\r\n                el.className += ' ' + str;\r\n            }\r\n        });\r\n        return this;\r\n    };\r\n    TSDom.prototype.removeClass = function (str) {\r\n        var _this = this;\r\n        this.each(function (el) {\r\n            if (_this.hasClass(str)) {\r\n                var reg = new RegExp('(\\\\s|^)' + str + '(\\\\s|$)');\r\n                el.className = el.className.replace(reg, ' ');\r\n            }\r\n        });\r\n        return this;\r\n    };\r\n    TSDom.prototype.on = function (ev, op1, op2) {\r\n        var self = this;\r\n        var direct = typeof op1 === 'function' && op2 === undefined;\r\n        var child = typeof op1 === 'string' && typeof op2 === 'function';\r\n        this.off(ev);\r\n        this.each(function (el) {\r\n            var cb = null;\r\n            if (direct) {\r\n                cb = op1;\r\n                el.addEventListener(ev, cb, false);\r\n            }\r\n            if (child) {\r\n                cb = function (ev) {\r\n                    var hit = false;\r\n                    var els = new TSDom(op1, el);\r\n                    els.each(function (_el) {\r\n                        if (ev.target == _el) {\r\n                            hit = true;\r\n                        }\r\n                    });\r\n                    if (hit)\r\n                        op2(ev);\r\n                };\r\n                el.addEventListener(ev, cb, false);\r\n            }\r\n            if (cb)\r\n                self.events.push({\r\n                    type: ev,\r\n                    handler: cb\r\n                });\r\n        });\r\n        return this;\r\n    };\r\n    TSDom.prototype.off = function (ev) {\r\n        var _this = this;\r\n        var self = this;\r\n        var events = this.events;\r\n        this.each(function (el) {\r\n            var active = _this.findEvent(ev);\r\n            if (active !== undefined) {\r\n                el.removeEventListener(ev, active.handler, false);\r\n            }\r\n        });\r\n        this.events = events.filter(function (evt) {\r\n            return (evt.type !== ev);\r\n        }, event);\r\n        return this;\r\n    };\r\n    TSDom.prototype.append = function (html) {\r\n        this.each(function (el) {\r\n            el.insertAdjacentHTML('beforeend', html);\r\n        });\r\n        return this;\r\n    };\r\n    TSDom.prototype.prepend = function (html) {\r\n        this.each(function (el) {\r\n            el.insertAdjacentHTML('afterbegin', html);\r\n        });\r\n        return this;\r\n    };\r\n    TSDom.prototype.query = function (qry, ctx) {\r\n        var doc = this.document;\r\n        var test;\r\n        var match;\r\n        if ((test = this.regex.exec(qry))) {\r\n            if ((match = test[3])) {\r\n                return ctx.getElementsByClassName(match);\r\n            }\r\n            if ((match = test[2])) {\r\n                return ctx.getElementsByTagName(match);\r\n            }\r\n            if ((match = test[1])) {\r\n                return doc.getElementById(match);\r\n            }\r\n        }\r\n        return ctx.querySelectorAll(qry);\r\n    };\r\n    TSDom.prototype.findEvent = function (ev) {\r\n        var events = this.events;\r\n        return events.filter(function (_ev) {\r\n            return (_ev.type === ev);\r\n        }, ev)[0];\r\n    };\r\n    return TSDom;\r\n}());\r\nexports.TSDom = TSDom;\r\n/* -----------------------------------\r\n *\r\n * preventDefault\r\n *\r\n * -------------------------------- */\r\nfunction preventDefault(ev) {\r\n    if (ev.preventDefault) {\r\n        return ev.preventDefault();\r\n    }\r\n    return ev.returnValue = false;\r\n}\r\nexports.preventDefault = preventDefault;\r\n/* -----------------------------------\r\n *\r\n * Export\r\n *\r\n * -------------------------------- */\r\nexports.default = function (qry, ctx) {\r\n    return new TSDom(qry, ctx);\r\n};\r\n},{}]},{},[1])(1)\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvaW5jbHVkZS5qcyIsInNyYy9pbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBOzs7QUNFQTs7OztzQ0FJc0M7O0FBbUJ0Qzs7OztzQ0FJc0M7QUFFdEM7SUFhRyxlQUFtQixHQUF5QixFQUFFLEdBQWEsRUFBRSxJQUFnQjtRQUUxRSxJQUFJLEdBQVEsQ0FBQztRQUViLElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDO1FBQ3pCLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxJQUFJLEVBQUUsQ0FBQztRQUN2QixJQUFJLENBQUMsS0FBSyxHQUFHLGtDQUFrQyxDQUFDO1FBQ2hELElBQUksQ0FBQyxNQUFNLEdBQUcsRUFBRSxDQUFDO1FBRWpCLEVBQUUsQ0FBQSxDQUFDLE9BQU8sR0FBRyxLQUFLLFFBQVEsQ0FBQyxDQUFDLENBQUM7WUFFMUIsR0FBRyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxFQUFFLEdBQUcsR0FBRyxHQUFHLEdBQUcsUUFBUSxDQUFDLENBQUM7UUFFL0MsQ0FBQztRQUFDLElBQUksQ0FBQyxDQUFDO1lBRUwsR0FBRyxHQUFHLEdBQUcsQ0FBQztRQUViLENBQUM7UUFFRCxFQUFFLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQztZQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUE7UUFFckIsRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLFFBQVEsS0FBSyxDQUFDLElBQUksR0FBRyxLQUFLLE1BQU0sQ0FBQyxDQUFDLENBQUM7WUFFeEMsSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQztZQUNkLElBQUksQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFBO1FBRWxCLENBQUM7UUFBQyxJQUFJLENBQUMsQ0FBQztZQUVMLEdBQUcsQ0FBQyxDQUNELElBQUksR0FBRyxHQUFHLENBQUMsSUFBSSxDQUFDLE1BQU0sR0FBRyxHQUFH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Z0JBRXJCLE1BQU0sQ0FBQyxHQUFHLENBQUMsY0FBYyxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBRXBDLENBQUM7UUFFSixDQUFDO1FBRUQsTUFBTSxDQUFDLEdBQUcsQ0FBQyxnQkFBZ0IsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUVwQyxDQUFDO0lBR08seUJBQVMsR0FBakIsVUFBa0IsRUFBVTtRQUVqQixJQUFBLG9CQUFNLENBQVU7UUFFeEIsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsVUFBUyxHQUFHO1lBRTlCLE1BQU0sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxJQUFJLEtBQUssRUFBRSxDQUFDLENBQUM7UUFFNUIsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBRWIsQ0FBQztJQUdKLFlBQUM7QUFBRCxDQXRUQSxBQXNUQyxJQUFBO0FBdFRZLHNCQUFLO0FBeVRsQjs7OztzQ0FJc0M7QUFFdEMsd0JBQStCLEVBQVM7SUFFckMsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUM7UUFFckIsTUFBTSxDQUFDLEVBQUUsQ0FBQyxjQUFjLEVBQUUsQ0FBQztJQUU5QixDQUFDO0lBRUQsTUFBTSxDQUFDLEVBQUUsQ0FBQyxXQUFXLEdBQUcsS0FBSyxDQUFDO0FBRWpDLENBQUM7QUFWRCx3Q0FVQztBQUdEOzs7O3NDQUlzQztBQUV0QyxrQkFBZSxVQUFDLEdBQXlCLEVBQUUsR0FBaUI7SUFFekQsTUFBTSxDQUFDLElBQUksS0FBSyxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQztBQUU5QixDQUFDLENBQUMiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuL2luZGV4JykuZGVmYXVsdDsiLCJcclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAqXHJcbiAqIE1ldGFcclxuICpcclxuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSVRTRF9NZXRhIHtcclxuICAgb3duZXI/OiBUU0RvbTtcclxufVxyXG5cclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAqXHJcbiAqIEV2ZW50c1xyXG4gKlxyXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJVFNEX0V2ZW50cyB7XHJcbiAgIHR5cGU6IHN0cmluZztcclxuICAgaGFuZGxlcjogRXZlbnRMaXN0ZW5lcjtcclxufVxyXG5cclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAqXHJcbiAqIFRTRG9tXHJcbiAqXHJcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG5leHBvcnQgY2xhc3MgVFNEb20ge1xyXG5cclxuXHJcbiAgIFtpbmRleDogbnVtYmVyXTogSFRNTEVsZW1lbnQ7XHJcblxyXG5cclxuICAgZG9jdW1lbnQ6IERvY3VtZW50O1xyXG4gICBtZXRhOiBJVFNEX01ldGE7XHJcbiAgIHJlZ2V4OiBSZWdFeHA7XHJcbiAgIGxlbmd0aDogbnVtYmVyO1xyXG4gICBldmVudHM6IElUU0RfRXZlbnRzW107XHJcblxyXG5cclxuICAgcHVibGljIGNvbnN0cnVjdG9yKHFyeTogc3RyaW5nIHwgSFRNTEVsZW1lbnQsIGN0eD86IEVsZW1lbnQsIG1ldGE/OiBJVFNEX01ldGEpIHtcclxuXHJcbiAgICAgIGxldCBlbHM6IGFueTtcclxuXHJcbiAgICAgIHRoaXMuZG9jdW1lbnQgPSBkb2N1bWVudDtcclxuICAgICAgdGhpcy5tZXRhID0gbWV0YSB8fCB7fTtcclxuICAgICAgdGhpcy5yZWdleCA9IC9eKD86IyhbXFx3LV0rKXwoXFx3Kyl8XFwuKFtcXHctXSspKSQvO1xyXG4gICAgICB0aGlzLmV2ZW50cyA9IFtdO1xyXG5cclxuICAgICAgaWYodHlwZW9mIHFyeSA9PT0gJ3N0cmluZycpIHtcclxuXHJcbiAgICAgICAgIGVscyA9IHRoaXMucXVlcnkocXJ5LCBjdHggPyBjdHggOiBkb2N1bWVudCk7XHJcblxyXG4gICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgZWxzID0gcXJ5O1xyXG5cclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKCFlbHMpIHJldHVybiB0aGlzXHJcblxyXG4gICAgICBpZiAoZWxzLm5vZGVUeXBlID09PSAxIHx8IGVscyA9PT0gd2luZG93KSB7XHJcbiAgICAgICAgIFxyXG4gICAgICAgICB0aGlzWzBdID0gZWxzO1xyXG4gICAgICAgICB0aGlzLmxlbmd0aCA9IDFcclxuICAgIFxyXG4gICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgZm9yIChcclxuICAgICAgICAgICAgbGV0IGxlbiA9ICh0aGlzLmxlbmd0aCA9IGVscy5sZW5ndGgpO1xyXG4gICAgICAgICAgICBsZW4tLTtcclxuICAgICAgICAgICAgdGhpc1tsZW5dID0gZWxzW2xlbl1cclxuICAgICAgICAgKTtcclxuXHJcbiAgICAgIH1cclxuXHJcbiAgIH1cclxuXHJcblxyXG4gICBwdWJsaWMgZmluZCAocXJ5OiBzdHJpbmcpIHtcclxuXHJcbiAgICAgIHJldHVybiBuZXcgVFNEb20ocXJ5LCB0aGlzWzBdLCB7IG93bmVyOiB0aGlzIH0pO1xyXG5cclxuICAgfVxyXG5cclxuXHJcbiAgIHB1YmxpYyBlYWNoIChjYjogKGVsOiBIVE1MRWxlbWVudCkgPT4gdm9pZCkge1xyXG5cclxuICAgICAgZm9yKGxldCBpID0gMCwgbGVuID0gdGhpcy5sZW5ndGg7IGkgPCBsZW47KSB7XHJcblxyXG4gICAgICAgICBsZXQgZWw6IEhUTUxFbGVtZW50ID0gdGhpc1tpXTtcclxuXHJcbiAgICAgICAgIGlmKGNiLmNhbGwodGhpcywgdGhpc1tpXSwgaSsrKSA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgfVxyXG5cclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHRoaXM7XHJcblxyXG4gICB9XHJcblxyXG5cclxuICAgcHVibGljIGNzcyhvYmo6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH0pIHtcclxuXHJcbiAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xyXG5cclxuICAgICAgdGhpcy5lYWNoKGVsID0+IHtcclxuXHJcbiAgICAgICAgIGZvcihsZXQga2V5IGluIG9iaikge1xyXG5cclxuICAgICAgICAgICAgY29uc3QgdmFsID0gb2JqW2tleV07XHJcblxyXG4gICAgICAgICAgICBlbC5zdHlsZS5zZXRQcm9wZXJ0eShrZXksIHZhbCk7XHJcblxyXG4gICAgICAgICB9XHJcblxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG5cclxuICAgfVxyXG5cclxuXHJcbiAgIHB1YmxpYyBoYXNDbGFzcyhzdHI6IHN0cmluZykge1xyXG5cclxuICAgICAgbGV0IHJlc3VsdCA9IGZhbHNlO1xyXG5cclxuICAgICAgdGhpcy5lYWNoKGVsID0+IHtcclxuXHJcbiAgICAgICAgIGNvbnN0IHZhbHVlID0gYCAke3N0cn0gYDtcclxuICAgICAgICAgY29uc3QgY2xlYW4gPSAoYCAke2VsLmNsYXNzTmFtZX0gYCkucmVwbGFjZSgvW1xcblxcdF0vZywgJyAnKTtcclxuXHJcbiAgICAgICAgIGlmKGNsZWFuLmluZGV4T2YodmFsdWUpID4gLTEpIHtcclxuXHJcbiAgICAgICAgICAgIHJlc3VsdCA9IHRydWU7XHJcblxyXG4gICAgICAgICB9XHJcblxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHJldHVybiByZXN1bHQ7XHJcblxyXG4gICB9XHJcblxyXG5cclxuICAgcHVibGljIGFkZENsYXNzKHN0cjogc3RyaW5nKSB7XHJcblxyXG4gICAgICB0aGlzLmVhY2goZWwgPT4ge1xyXG5cclxuICAgICAgICAgaWYoIXRoaXMuaGFzQ2xhc3Moc3RyKSkge1xyXG5cclxuICAgICAgICAgICAgZWwuY2xhc3NOYW1lICs9ICcgJyArIHN0cjtcclxuXHJcbiAgICAgICAgIH1cclxuXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmV0dXJuIHRoaXM7XHJcblxyXG4gICB9XHJcblxyXG5cclxuICAgcHVibGljIHJlbW92ZUNsYXNzKHN0cjogc3RyaW5nKSB7XHJcblxyXG4gICAgICB0aGlzLmVhY2goZWwgPT4ge1xyXG5cclxuICAgICAgICAgaWYodGhpcy5oYXNDbGFzcyhzdHIpKSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgcmVnID0gbmV3IFJlZ0V4cCgnKFxcXFxzfF4pJyArIHN0ciArICcoXFxcXHN8JCknKTtcclxuXHJcbiAgICAgICAgICAgIGVsLmNsYXNzTmFtZSA9IGVsLmNsYXNzTmFtZS5yZXBsYWNlKHJlZywgJyAnKTtcclxuXHJcbiAgICAgICAgIH1cclxuXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmV0dXJuIHRoaXM7XHJcblxyXG4gICB9XHJcblxyXG5cclxuICAgcHVibGljIG9uIChldjogc3RyaW5nLCBvcDE6IHN0cmluZyB8IEV2ZW50TGlzdGVuZXIsIG9wMj86IEV2ZW50TGlzdGVuZXIpIHtcclxuXHJcbiAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xyXG5cclxuICAgICAgY29uc3QgZGlyZWN0ID0gdHlwZW9mIG9wMSA9PT0gJ2Z1bmN0aW9uJyAmJiBvcDIgPT09IHVuZGVmaW5lZDtcclxuICAgICAgY29uc3QgY2hpbGQgPSB0eXBlb2Ygb3AxID09PSAnc3RyaW5nJyAmJiB0eXBlb2Ygb3AyID09PSAnZnVuY3Rpb24nO1xyXG5cclxuICAgICAgdGhpcy5vZmYoZXYpO1xyXG5cclxuICAgICAgdGhpcy5lYWNoKGVsID0+IHtcclxuXHJcbiAgICAgICAgIGxldCBjYiA9IG51bGw7XHJcblxyXG4gICAgICAgICBpZihkaXJlY3QpIHtcclxuXHJcbiAgICAgICAgICAgIGNiID0gPEV2ZW50TGlzdGVuZXI+b3AxO1xyXG5cclxuICAgICAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcihldiwgY2IsIGZhbHNlKTtcclxuXHJcbiAgICAgICAgIH1cclxuXHJcbiAgICAgICAgIGlmKGNoaWxkKSB7XHJcblxyXG4gICAgICAgICAgICBjYiA9IChldjogRXZlbnQpID0+IHtcclxuXHJcbiAgICAgICAgICAgICAgIGxldCBoaXQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgbGV0IGVscyA9IG5ldyBUU0RvbSg8c3RyaW5nPm9wMSwgZWwpO1xyXG5cclxuICAgICAgICAgICAgICAgZWxzLmVhY2goX2VsID0+IHtcclxuICAgICAgICAgICAgICAgICAgaWYoZXYudGFyZ2V0ID09IF9lbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICBoaXQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgaWYoaGl0KSBvcDIoZXYpO1xyXG4gICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoZXYsIGNiLCBmYWxzZSk7XHJcblxyXG4gICAgICAgICB9XHJcblxyXG4gICAgICAgICBpZihjYikgc2VsZi5ldmVudHMucHVzaCh7XHJcbiAgICAgICAgICAgIHR5cGU6IGV2LFxyXG4gICAgICAgICAgICBoYW5kbGVyOiBjYlxyXG4gICAgICAgICB9KTtcclxuXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmV0dXJuIHRoaXM7XHJcblxyXG4gICB9XHJcblxyXG4gICBcclxuICAgcHVibGljIG9mZiAoZXY6IHN0cmluZykge1xyXG5cclxuICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XHJcbiAgICAgIGNvbnN0IHsgZXZlbnRzIH0gPSB0aGlzOyBcclxuXHJcbiAgICAgIHRoaXMuZWFjaChlbCA9PiB7XHJcblxyXG4gICAgICAgICBjb25zdCBhY3RpdmUgPSB0aGlzLmZpbmRFdmVudChldik7XHJcblxyXG4gICAgICAgICBpZihhY3RpdmUgIT09IHVuZGVmaW5lZCkge1xyXG5cclxuICAgICAgICAgICAgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihldiwgYWN0aXZlLmhhbmRsZXIsIGZhbHNlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgIH1cclxuXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgdGhpcy5ldmVudHMgPSBldmVudHMuZmlsdGVyKGZ1bmN0aW9uKGV2dCkge1xyXG4gICAgICBcclxuICAgICAgICAgcmV0dXJuIChldnQudHlwZSAhPT0gZXYpO1xyXG4gICAgICBcclxuICAgICAgfSwgZXZlbnQpO1xyXG5cclxuICAgICAgcmV0dXJuIHRoaXM7XHJcblxyXG4gICB9XHJcblxyXG5cclxuICAgcHVibGljIGFwcGVuZChodG1sOiBzdHJpbmcpIHtcclxuXHJcbiAgICAgIHRoaXMuZWFjaChlbCA9PiB7XHJcblxyXG4gICAgICAgICBlbC5pbnNlcnRBZGphY2VudEhUTUwoJ2JlZm9yZWVuZCcsIGh0bWwpO1xyXG5cclxuICAgICAgfSk7XHJcblxyXG4gICAgICByZXR1cm4gdGhpcztcclxuXHJcbiAgIH1cclxuXHJcblxyXG4gICBwdWJsaWMgcHJlcGVuZChodG1sOiBzdHJpbmcpIHtcclxuXHJcbiAgICAgIHRoaXMuZWFjaChlbCA9PiB7XHJcblxyXG4gICAgICAgICBlbC5pbnNlcnRBZGphY2VudEhUTUwoJ2FmdGVyYmVnaW4nLCBodG1sKTtcclxuXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmV0dXJuIHRoaXM7XHJcblxyXG4gICB9XHJcblxyXG5cclxuICAgcHJpdmF0ZSBxdWVyeShxcnk6IHN0cmluZywgY3R4OiBFbGVtZW50IHwgRG9jdW1lbnQpIHtcclxuXHJcbiAgICAgIGNvbnN0IGRvYyA9IHRoaXMuZG9jdW1lbnQ7XHJcblxyXG4gICAgICBsZXQgdGVzdDtcclxuICAgICAgbGV0IG1hdGNoO1xyXG5cclxuICAgICAgaWYgKCh0ZXN0ID0gdGhpcy5yZWdleC5leGVjKHFyeSkpKSB7XHJcblxyXG4gICAgICAgICBpZiAoKG1hdGNoID0gdGVzdFszXSkpIHtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBjdHguZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShtYXRjaCk7XHJcblxyXG4gICAgICAgICB9XHJcblxyXG4gICAgICAgICBpZiAoKG1hdGNoID0gdGVzdFsyXSkpIHtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBjdHguZ2V0RWxlbWVudHNCeVRhZ05hbWUobWF0Y2gpO1xyXG5cclxuICAgICAgICAgfVxyXG5cclxuICAgICAgICAgaWYgKChtYXRjaCA9IHRlc3RbMV0pKSB7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZG9jLmdldEVsZW1lbnRCeUlkKG1hdGNoKTtcclxuXHJcbiAgICAgICAgIH1cclxuXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBjdHgucXVlcnlTZWxlY3RvckFsbChxcnkpO1xyXG5cclxuICAgfVxyXG5cclxuXHJcbiAgIHByaXZhdGUgZmluZEV2ZW50KGV2OiBzdHJpbmcpIHtcclxuXHJcbiAgICAgIGNvbnN0IHsgZXZlbnRzIH0gPSB0aGlzO1xyXG5cclxuICAgICAgcmV0dXJuIGV2ZW50cy5maWx0ZXIoZnVuY3Rpb24oX2V2KSB7XHJcblxyXG4gICAgICAgICByZXR1cm4gKF9ldi50eXBlID09PSBldik7XHJcblxyXG4gICAgICB9LCBldilbMF07XHJcblxyXG4gICB9XHJcblxyXG5cclxufVxyXG5cclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAqXHJcbiAqIHByZXZlbnREZWZhdWx0XHJcbiAqXHJcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcHJldmVudERlZmF1bHQoZXY6IEV2ZW50KSB7XHJcblxyXG4gICBpZiAoZXYucHJldmVudERlZmF1bHQpIHtcclxuXHJcbiAgICAgIHJldHVybiBldi5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBcclxuICAgfVxyXG5cclxuICAgcmV0dXJuIGV2LnJldHVyblZhbHVlID0gZmFsc2U7XHJcblxyXG59XHJcblxyXG5cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICpcclxuICogRXhwb3J0XHJcbiAqXHJcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG5leHBvcnQgZGVmYXVsdCAocXJ5OiBzdHJpbmcgfCBIVE1MRWxlbWVudCwgY3R4PzogSFRNTEVsZW1lbnQpID0+IHtcclxuXHJcbiAgIHJldHVybiBuZXcgVFNEb20ocXJ5LCBjdHgpO1xyXG4gICBcclxufTsiXX0=\n"]}