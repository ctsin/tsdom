{"version":3,"sources":["tsdom.inc.js"],"names":["f","exports","module","define","amd","window","global","self","this","tsdom","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length","1","default","./index","2","Object","defineProperty","value","TSDomCore","qry","ctx","meta","els","document","regex","events","query","nodeType","len","prototype","find","owner","each","cb","css","obj","el","key","val","style","setProperty","hasClass","str","result","className","replace","indexOf","addClass","_this","removeClass","reg","RegExp","on","ev","op1","op2","direct","undefined","delegate","off","delegateEvent","addEventListener","push","type","handler","active","findEvent","removeEventListener","filter","evt","event","append","html","insertAdjacentHTML","prepend","test","match","doc","exec","getElementsByClassName","getElementsByTagName","getElementById","querySelectorAll","_ev","hit","_el","target","preventDefault","returnValue"],"mappings":"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","file":"tsdom.inc.js","sourcesContent":["(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.tsdom = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\nmodule.exports = require('./index').default;\n},{\"./index\":2}],2:[function(require,module,exports){\n\"use strict\";\r\n/* -----------------------------------\r\n *\r\n * Default\r\n *\r\n * -------------------------------- */\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/* -----------------------------------\r\n *\r\n * TSDom\r\n *\r\n * -------------------------------- */\r\nvar TSDomCore = (function () {\r\n    function TSDomCore(qry, ctx, meta) {\r\n        var els;\r\n        this.document = document;\r\n        this.meta = meta || {};\r\n        this.regex = /^(?:#([\\w-]+)|(\\w+)|\\.([\\w-]+))$/;\r\n        this.events = [];\r\n        if (typeof qry === 'string') {\r\n            els = this.query(qry, ctx ? ctx : document);\r\n        }\r\n        else {\r\n            els = qry;\r\n        }\r\n        if (!els)\r\n            return this;\r\n        if (els.nodeType === 1 || els === window) {\r\n            this[0] = els;\r\n            this.length = 1;\r\n        }\r\n        else {\r\n            for (var len = (this.length = els.length); len--; this[len] = els[len])\r\n                ;\r\n        }\r\n    }\r\n    TSDomCore.prototype.find = function (qry) {\r\n        return new TSDomCore(qry, this[0], { owner: this });\r\n    };\r\n    TSDomCore.prototype.each = function (cb) {\r\n        for (var i = 0, len = this.length; i < len;) {\r\n            var el = this[i];\r\n            if (cb.call(this, this[i], i++) == false) {\r\n                break;\r\n            }\r\n        }\r\n        return this;\r\n    };\r\n    TSDomCore.prototype.css = function (obj) {\r\n        var self = this;\r\n        this.each(function (el) {\r\n            for (var key in obj) {\r\n                var val = obj[key];\r\n                el.style.setProperty(key, val);\r\n            }\r\n        });\r\n        return this;\r\n    };\r\n    TSDomCore.prototype.hasClass = function (str) {\r\n        var result = false;\r\n        this.each(function (el) {\r\n            var value = \" \" + str + \" \";\r\n            var clean = (\" \" + el.className + \" \").replace(/[\\n\\t]/g, ' ');\r\n            if (clean.indexOf(value) > -1) {\r\n                result = true;\r\n            }\r\n        });\r\n        return result;\r\n    };\r\n    TSDomCore.prototype.addClass = function (str) {\r\n        var _this = this;\r\n        this.each(function (el) {\r\n            if (!_this.hasClass(str)) {\r\n                el.className += ' ' + str;\r\n            }\r\n        });\r\n        return this;\r\n    };\r\n    TSDomCore.prototype.removeClass = function (str) {\r\n        var _this = this;\r\n        this.each(function (el) {\r\n            if (_this.hasClass(str)) {\r\n                var reg = new RegExp('(\\\\s|^)' + str + '(\\\\s|$)');\r\n                el.className = el.className.replace(reg, ' ');\r\n            }\r\n        });\r\n        return this;\r\n    };\r\n    TSDomCore.prototype.on = function (ev, op1, op2) {\r\n        var self = this;\r\n        var direct = typeof op1 === 'function' && op2 === undefined;\r\n        var delegate = typeof op1 === 'string' && typeof op2 === 'function';\r\n        this.off(ev);\r\n        this.each(function (el) {\r\n            var cb = null;\r\n            if (direct) {\r\n                cb = op1;\r\n            }\r\n            if (delegate) {\r\n                cb = self.delegateEvent(el, op1, op2);\r\n            }\r\n            if (cb) {\r\n                el.addEventListener(ev, cb, false);\r\n                self.events.push({\r\n                    type: ev,\r\n                    handler: cb\r\n                });\r\n            }\r\n            else {\r\n                throw new Error('TSDom.on: Invalid Arguments');\r\n            }\r\n        });\r\n        return this;\r\n    };\r\n    TSDomCore.prototype.off = function (ev) {\r\n        var _this = this;\r\n        var self = this;\r\n        var events = this.events;\r\n        this.each(function (el) {\r\n            var active = _this.findEvent(ev);\r\n            if (active !== undefined) {\r\n                el.removeEventListener(ev, active.handler, false);\r\n            }\r\n        });\r\n        this.events = events.filter(function (evt) {\r\n            return (evt.type !== ev);\r\n        }, event);\r\n        return this;\r\n    };\r\n    TSDomCore.prototype.append = function (html) {\r\n        this.each(function (el) {\r\n            el.insertAdjacentHTML('beforeend', html);\r\n        });\r\n        return this;\r\n    };\r\n    TSDomCore.prototype.prepend = function (html) {\r\n        this.each(function (el) {\r\n            el.insertAdjacentHTML('afterbegin', html);\r\n        });\r\n        return this;\r\n    };\r\n    TSDomCore.prototype.query = function (qry, ctx) {\r\n        var doc = this.document;\r\n        var test;\r\n        var match;\r\n        if ((test = this.regex.exec(qry))) {\r\n            if ((match = test[3])) {\r\n                return ctx.getElementsByClassName(match);\r\n            }\r\n            if ((match = test[2])) {\r\n                return ctx.getElementsByTagName(match);\r\n            }\r\n            if ((match = test[1])) {\r\n                return doc.getElementById(match);\r\n            }\r\n        }\r\n        return ctx.querySelectorAll(qry);\r\n    };\r\n    TSDomCore.prototype.findEvent = function (ev) {\r\n        var events = this.events;\r\n        return events.filter(function (_ev) {\r\n            return (_ev.type === ev);\r\n        }, ev)[0];\r\n    };\r\n    TSDomCore.prototype.delegateEvent = function (el, qry, cb) {\r\n        return function (ev) {\r\n            var hit = false;\r\n            var els = new TSDomCore(qry, el);\r\n            els.each(function (_el) {\r\n                if (ev.target == _el) {\r\n                    hit = true;\r\n                }\r\n            });\r\n            if (hit)\r\n                cb(ev);\r\n        };\r\n    };\r\n    return TSDomCore;\r\n}());\r\nexports.TSDomCore = TSDomCore;\r\n/* -----------------------------------\r\n *\r\n * preventDefault\r\n *\r\n * -------------------------------- */\r\nfunction preventDefault(ev) {\r\n    if (ev.preventDefault) {\r\n        return ev.preventDefault();\r\n    }\r\n    return ev.returnValue = false;\r\n}\r\nexports.preventDefault = preventDefault;\r\n/* -----------------------------------\r\n *\r\n * Export\r\n *\r\n * -------------------------------- */\r\nexports.default = function (qry, ctx) {\r\n    return new TSDomCore(qry, ctx);\r\n};\r\n},{}]},{},[1])(1)\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvaW5jbHVkZS5qcyIsInNyYy9pbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBOzs7QUNFQTs7OztzQ0FJc0M7O0FBOEJ0Qzs7OztzQ0FJc0M7QUFFdEM7SUFhRyxtQkFBbUIsR0FBeUIsRUFBRSxHQUFhLEVBQUUsSUFBZ0I7UUFFMUUsSUFBSSxHQUFRLENBQUM7UUFFYixJQUFJLENBQUMsUUFBUSxHQUFHLFFBQVEsQ0FBQztRQUN6QixJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksSUFBSSxFQUFFLENBQUM7UUFDdkIsSUFBSSxDQUFDLEtBQUssR0FBRyxrQ0FBa0MsQ0FBQztRQUNoRCxJQUFJLENBQUMsTUFBTSxHQUFHLEVBQUUsQ0FBQztRQUVqQixFQUFFLENBQUEsQ0FBQyxPQUFPLEdBQUcsS0FBSyxRQUFRLENBQUMsQ0FBQyxDQUFDO1lBRTFCLEdBQUcsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsRUFBRSxHQUFHLEdBQUcsR0FBRyxHQUFHLFFBQVEsQ0FBQyxDQUFDO1FBRS9DLENBQUM7UUFBQyxJQUFJLENBQUMsQ0FBQztZQUVMLEdBQUcsR0FBRyxHQUFHLENBQUM7UUFFYixDQUFDO1FBRUQsRUFBRSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUM7WUFBQyxNQUFNLENBQUMsSUFBSSxDQUFBO1FBRXJCLEVBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxRQUFRLEtBQUssQ0FBQyxJQUFJLEdBQUcsS0FBSyxNQUFNLENBQUMsQ0FBQyxDQUFDO1lBRXhDLElBQUksQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUM7WUFDZCxJQUFJLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQTtRQUVsQixDQUFDO1FBQUMsSUFBSSxDQUFDLENBQUM7WUFFTCxHQUFHLENBQUMsQ0FDRCxJQUFJLEdBQUcsR0FBRyxDQUFDLElBQUksQ0FBQyxNQUFNLEdBQUcsR0FB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Um9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuL2luZGV4JykuZGVmYXVsdDsiLCJcclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAqXHJcbiAqIERlZmF1bHRcclxuICpcclxuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgVFNEb20ge1xyXG4gICAocXJ5OiBzdHJpbmcgfCBIVE1MRWxlbWVudCwgY3R4PzogRWxlbWVudCwgbWV0YT86IFRTRG9tTWV0YSk6IFRTRG9tQ29yZVxyXG59XHJcblxyXG5cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICpcclxuICogTWV0YVxyXG4gKlxyXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBUU0RvbU1ldGEge1xyXG4gICBvd25lcj86IFRTRG9tQ29yZTtcclxufVxyXG5cclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAqXHJcbiAqIEV2ZW50c1xyXG4gKlxyXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBUU0RvbUV2ZW50cyB7XHJcbiAgIHR5cGU6IHN0cmluZztcclxuICAgaGFuZGxlcjogRXZlbnRMaXN0ZW5lcjtcclxufVxyXG5cclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAqXHJcbiAqIFRTRG9tXHJcbiAqXHJcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG5leHBvcnQgY2xhc3MgVFNEb21Db3JlIHtcclxuXHJcblxyXG4gICBbaW5kZXg6IG51bWJlcl06IEhUTUxFbGVtZW50O1xyXG5cclxuXHJcbiAgIGRvY3VtZW50OiBEb2N1bWVudDtcclxuICAgbWV0YTogVFNEb21NZXRhO1xyXG4gICByZWdleDogUmVnRXhwO1xyXG4gICBsZW5ndGg6IG51bWJlcjtcclxuICAgZXZlbnRzOiBUU0RvbUV2ZW50c1tdO1xyXG5cclxuXHJcbiAgIHB1YmxpYyBjb25zdHJ1Y3Rvcihxcnk6IHN0cmluZyB8IEhUTUxFbGVtZW50LCBjdHg/OiBFbGVtZW50LCBtZXRhPzogVFNEb21NZXRhKSB7XHJcblxyXG4gICAgICBsZXQgZWxzOiBhbnk7XHJcblxyXG4gICAgICB0aGlzLmRvY3VtZW50ID0gZG9jdW1lbnQ7XHJcbiAgICAgIHRoaXMubWV0YSA9IG1ldGEgfHwge307XHJcbiAgICAgIHRoaXMucmVnZXggPSAvXig/OiMoW1xcdy1dKyl8KFxcdyspfFxcLihbXFx3LV0rKSkkLztcclxuICAgICAgdGhpcy5ldmVudHMgPSBbXTtcclxuXHJcbiAgICAgIGlmKHR5cGVvZiBxcnkgPT09ICdzdHJpbmcnKSB7XHJcblxyXG4gICAgICAgICBlbHMgPSB0aGlzLnF1ZXJ5KHFyeSwgY3R4ID8gY3R4IDogZG9jdW1lbnQpO1xyXG5cclxuICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgIGVscyA9IHFyeTtcclxuXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmICghZWxzKSByZXR1cm4gdGhpc1xyXG5cclxuICAgICAgaWYgKGVscy5ub2RlVHlwZSA9PT0gMSB8fCBlbHMgPT09IHdpbmRvdykge1xyXG4gICAgICAgICBcclxuICAgICAgICAgdGhpc1swXSA9IGVscztcclxuICAgICAgICAgdGhpcy5sZW5ndGggPSAxXHJcbiAgICBcclxuICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgIGZvciAoXHJcbiAgICAgICAgICAgIGxldCBsZW4gPSAodGhpcy5sZW5ndGggPSBlbHMubGVuZ3RoKTtcclxuICAgICAgICAgICAgbGVuLS07XHJcbiAgICAgICAgICAgIHRoaXNbbGVuXSA9IGVsc1tsZW5dXHJcbiAgICAgICAgICk7XHJcblxyXG4gICAgICB9XHJcblxyXG4gICB9XHJcblxyXG5cclxuICAgcHVibGljIGZpbmQgKHFyeTogc3RyaW5nKSB7XHJcblxyXG4gICAgICByZXR1cm4gbmV3IFRTRG9tQ29yZShxcnksIHRoaXNbMF0sIHsgb3duZXI6IHRoaXMgfSk7XHJcblxyXG4gICB9XHJcblxyXG5cclxuICAgcHVibGljIGVhY2ggKGNiOiAoZWw6IEhUTUxFbGVtZW50KSA9PiB2b2lkKSB7XHJcblxyXG4gICAgICBmb3IobGV0IGkgPSAwLCBsZW4gPSB0aGlzLmxlbmd0aDsgaSA8IGxlbjspIHtcclxuXHJcbiAgICAgICAgIGxldCBlbDogSFRNTEVsZW1lbnQgPSB0aGlzW2ldO1xyXG5cclxuICAgICAgICAgaWYoY2IuY2FsbCh0aGlzLCB0aGlzW2ldLCBpKyspID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICB9XHJcblxyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gdGhpcztcclxuXHJcbiAgIH1cclxuXHJcblxyXG4gICBwdWJsaWMgY3NzKG9iajogeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfSkge1xyXG5cclxuICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XHJcblxyXG4gICAgICB0aGlzLmVhY2goZWwgPT4ge1xyXG5cclxuICAgICAgICAgZm9yKGxldCBrZXkgaW4gb2JqKSB7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB2YWwgPSBvYmpba2V5XTtcclxuXHJcbiAgICAgICAgICAgIGVsLnN0eWxlLnNldFByb3BlcnR5KGtleSwgdmFsKTtcclxuXHJcbiAgICAgICAgIH1cclxuXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmV0dXJuIHRoaXM7XHJcblxyXG4gICB9XHJcblxyXG5cclxuICAgcHVibGljIGhhc0NsYXNzKHN0cjogc3RyaW5nKSB7XHJcblxyXG4gICAgICBsZXQgcmVzdWx0ID0gZmFsc2U7XHJcblxyXG4gICAgICB0aGlzLmVhY2goZWwgPT4ge1xyXG5cclxuICAgICAgICAgY29uc3QgdmFsdWUgPSBgICR7c3RyfSBgO1xyXG4gICAgICAgICBjb25zdCBjbGVhbiA9IChgICR7ZWwuY2xhc3NOYW1lfSBgKS5yZXBsYWNlKC9bXFxuXFx0XS9nLCAnICcpO1xyXG5cclxuICAgICAgICAgaWYoY2xlYW4uaW5kZXhPZih2YWx1ZSkgPiAtMSkge1xyXG5cclxuICAgICAgICAgICAgcmVzdWx0ID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgIH1cclxuXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmV0dXJuIHJlc3VsdDtcclxuXHJcbiAgIH1cclxuXHJcblxyXG4gICBwdWJsaWMgYWRkQ2xhc3Moc3RyOiBzdHJpbmcpIHtcclxuXHJcbiAgICAgIHRoaXMuZWFjaChlbCA9PiB7XHJcblxyXG4gICAgICAgICBpZighdGhpcy5oYXNDbGFzcyhzdHIpKSB7XHJcblxyXG4gICAgICAgICAgICBlbC5jbGFzc05hbWUgKz0gJyAnICsgc3RyO1xyXG5cclxuICAgICAgICAgfVxyXG5cclxuICAgICAgfSk7XHJcblxyXG4gICAgICByZXR1cm4gdGhpcztcclxuXHJcbiAgIH1cclxuXHJcblxyXG4gICBwdWJsaWMgcmVtb3ZlQ2xhc3Moc3RyOiBzdHJpbmcpIHtcclxuXHJcbiAgICAgIHRoaXMuZWFjaChlbCA9PiB7XHJcblxyXG4gICAgICAgICBpZih0aGlzLmhhc0NsYXNzKHN0cikpIHtcclxuXHJcbiAgICAgICAgICAgIHZhciByZWcgPSBuZXcgUmVnRXhwKCcoXFxcXHN8XiknICsgc3RyICsgJyhcXFxcc3wkKScpO1xyXG5cclxuICAgICAgICAgICAgZWwuY2xhc3NOYW1lID0gZWwuY2xhc3NOYW1lLnJlcGxhY2UocmVnLCAnICcpO1xyXG5cclxuICAgICAgICAgfVxyXG5cclxuICAgICAgfSk7XHJcblxyXG4gICAgICByZXR1cm4gdGhpcztcclxuXHJcbiAgIH1cclxuXHJcblxyXG4gICBwdWJsaWMgb24gKGV2OiBzdHJpbmcsIG9wMTogc3RyaW5nIHwgRXZlbnRMaXN0ZW5lciwgb3AyPzogRXZlbnRMaXN0ZW5lcikge1xyXG5cclxuICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XHJcblxyXG4gICAgICBjb25zdCBkaXJlY3QgPSB0eXBlb2Ygb3AxID09PSAnZnVuY3Rpb24nICYmIG9wMiA9PT0gdW5kZWZpbmVkO1xyXG4gICAgICBjb25zdCBkZWxlZ2F0ZSA9IHR5cGVvZiBvcDEgPT09ICdzdHJpbmcnICYmIHR5cGVvZiBvcDIgPT09ICdmdW5jdGlvbic7XHJcblxyXG4gICAgICB0aGlzLm9mZihldik7XHJcblxyXG4gICAgICB0aGlzLmVhY2goZWwgPT4ge1xyXG5cclxuICAgICAgICAgbGV0IGNiID0gbnVsbDtcclxuXHJcbiAgICAgICAgIGlmKGRpcmVjdCkge1xyXG4gICAgICAgICAgICBjYiA9IDxFdmVudExpc3RlbmVyPm9wMTtcclxuICAgICAgICAgfVxyXG5cclxuICAgICAgICAgaWYoZGVsZWdhdGUpIHtcclxuICAgICAgICAgICAgY2IgPSBzZWxmLmRlbGVnYXRlRXZlbnQoZWwsIDxzdHJpbmc+b3AxLCBvcDIpO1xyXG4gICAgICAgICB9XHJcblxyXG4gICAgICAgICBpZihjYikge1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcihldiwgY2IsIGZhbHNlKTtcclxuXHJcbiAgICAgICAgICAgIHNlbGYuZXZlbnRzLnB1c2goe1xyXG4gICAgICAgICAgICAgICB0eXBlOiBldixcclxuICAgICAgICAgICAgICAgaGFuZGxlcjogY2JcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RTRG9tLm9uOiBJbnZhbGlkIEFyZ3VtZW50cycpO1xyXG4gICAgICAgICB9XHJcblxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG5cclxuICAgfVxyXG5cclxuICAgXHJcbiAgIHB1YmxpYyBvZmYgKGV2OiBzdHJpbmcpIHtcclxuXHJcbiAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xyXG4gICAgICBjb25zdCB7IGV2ZW50cyB9ID0gdGhpczsgXHJcblxyXG4gICAgICB0aGlzLmVhY2goZWwgPT4ge1xyXG5cclxuICAgICAgICAgY29uc3QgYWN0aXZlID0gdGhpcy5maW5kRXZlbnQoZXYpO1xyXG5cclxuICAgICAgICAgaWYoYWN0aXZlICE9PSB1bmRlZmluZWQpIHtcclxuXHJcbiAgICAgICAgICAgIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXYsIGFjdGl2ZS5oYW5kbGVyLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICB9XHJcblxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHRoaXMuZXZlbnRzID0gZXZlbnRzLmZpbHRlcihmdW5jdGlvbihldnQpIHtcclxuICAgICAgXHJcbiAgICAgICAgIHJldHVybiAoZXZ0LnR5cGUgIT09IGV2KTtcclxuICAgICAgXHJcbiAgICAgIH0sIGV2ZW50KTtcclxuXHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG5cclxuICAgfVxyXG5cclxuXHJcbiAgIHB1YmxpYyBhcHBlbmQoaHRtbDogc3RyaW5nKSB7XHJcblxyXG4gICAgICB0aGlzLmVhY2goZWwgPT4ge1xyXG5cclxuICAgICAgICAgZWwuaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmVlbmQnLCBodG1sKTtcclxuXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmV0dXJuIHRoaXM7XHJcblxyXG4gICB9XHJcblxyXG5cclxuICAgcHVibGljIHByZXBlbmQoaHRtbDogc3RyaW5nKSB7XHJcblxyXG4gICAgICB0aGlzLmVhY2goZWwgPT4ge1xyXG5cclxuICAgICAgICAgZWwuaW5zZXJ0QWRqYWNlbnRIVE1MKCdhZnRlcmJlZ2luJywgaHRtbCk7XHJcblxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG5cclxuICAgfVxyXG5cclxuXHJcbiAgIHByaXZhdGUgcXVlcnkocXJ5OiBzdHJpbmcsIGN0eDogRWxlbWVudCB8IERvY3VtZW50KSB7XHJcblxyXG4gICAgICBjb25zdCBkb2MgPSB0aGlzLmRvY3VtZW50O1xyXG5cclxuICAgICAgbGV0IHRlc3Q7XHJcbiAgICAgIGxldCBtYXRjaDtcclxuXHJcbiAgICAgIGlmICgodGVzdCA9IHRoaXMucmVnZXguZXhlYyhxcnkpKSkge1xyXG5cclxuICAgICAgICAgaWYgKChtYXRjaCA9IHRlc3RbM10pKSB7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gY3R4LmdldEVsZW1lbnRzQnlDbGFzc05hbWUobWF0Y2gpO1xyXG5cclxuICAgICAgICAgfVxyXG5cclxuICAgICAgICAgaWYgKChtYXRjaCA9IHRlc3RbMl0pKSB7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gY3R4LmdldEVsZW1lbnRzQnlUYWdOYW1lKG1hdGNoKTtcclxuXHJcbiAgICAgICAgIH1cclxuXHJcbiAgICAgICAgIGlmICgobWF0Y2ggPSB0ZXN0WzFdKSkge1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGRvYy5nZXRFbGVtZW50QnlJZChtYXRjaCk7XHJcblxyXG4gICAgICAgICB9XHJcblxyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gY3R4LnF1ZXJ5U2VsZWN0b3JBbGwocXJ5KTtcclxuXHJcbiAgIH1cclxuXHJcblxyXG4gICBwcml2YXRlIGZpbmRFdmVudChldjogc3RyaW5nKSB7XHJcblxyXG4gICAgICBjb25zdCB7IGV2ZW50cyB9ID0gdGhpcztcclxuXHJcbiAgICAgIHJldHVybiBldmVudHMuZmlsdGVyKGZ1bmN0aW9uKF9ldikge1xyXG5cclxuICAgICAgICAgcmV0dXJuIChfZXYudHlwZSA9PT0gZXYpO1xyXG5cclxuICAgICAgfSwgZXYpWzBdO1xyXG5cclxuICAgfVxyXG5cclxuXHJcbiAgIHByaXZhdGUgZGVsZWdhdGVFdmVudChlbDogSFRNTEVsZW1lbnQsIHFyeTogc3RyaW5nLCBjYjogRXZlbnRMaXN0ZW5lcikge1xyXG5cclxuICAgICAgcmV0dXJuIChldjogRXZlbnQpID0+IHtcclxuXHJcbiAgICAgICAgIGxldCBoaXQgPSBmYWxzZTtcclxuICAgICAgICAgbGV0IGVscyA9IG5ldyBUU0RvbUNvcmUocXJ5LCBlbCk7XHJcblxyXG4gICAgICAgICBlbHMuZWFjaChfZWwgPT4ge1xyXG4gICAgICAgICAgICBpZihldi50YXJnZXQgPT0gX2VsKSB7XHJcbiAgICAgICAgICAgICAgIGhpdCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICBpZihoaXQpIGNiKGV2KTtcclxuICAgICAgICAgXHJcbiAgICAgIH07XHJcblxyXG4gICB9XHJcblxyXG5cclxufVxyXG5cclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAqXHJcbiAqIHByZXZlbnREZWZhdWx0XHJcbiAqXHJcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcHJldmVudERlZmF1bHQoZXY6IEV2ZW50KSB7XHJcblxyXG4gICBpZiAoZXYucHJldmVudERlZmF1bHQpIHtcclxuXHJcbiAgICAgIHJldHVybiBldi5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBcclxuICAgfVxyXG5cclxuICAgcmV0dXJuIGV2LnJldHVyblZhbHVlID0gZmFsc2U7XHJcblxyXG59XHJcblxyXG5cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICpcclxuICogRXhwb3J0XHJcbiAqXHJcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG5leHBvcnQgZGVmYXVsdCAocXJ5OiBzdHJpbmcgfCBIVE1MRWxlbWVudCwgY3R4PzogSFRNTEVsZW1lbnQpID0+IHtcclxuXHJcbiAgIHJldHVybiBuZXcgVFNEb21Db3JlKHFyeSwgY3R4KTtcclxuICAgXHJcbn07Il19\n"]}